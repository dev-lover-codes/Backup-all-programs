{"cells":[{"cell_type":"markdown","source":["Creating an AI voice agent that can control a computer is a powerful project. However, creating an agent that can \"do anything\" unchecked is a significant security risk (similar to giving a stranger remote control of your PC).\n","\n","The professional and safe approach is to build an **Agentic Workflow**. This means the AI doesn't just run random commands; instead, it selects from a list of specific \"Tools\" you have authorized, such as opening folders or running a syntax checker.\n","\n","Here is a complete, modular Python framework for a voice agent capable of opening system applications and checking code syntax.\n","\n","### **1. The Architecture**\n","\n","The system works in a loop:\n","\n","1. **Ear (STT):** Converts your voice to text.\n","2. **Brain (Router):** Analyzes the text to decide which function to call.\n","3. **Tools:** Pre-defined Python functions (e.g., `open_explorer`, `check_syntax`).\n","4. **Mouth (TTS):** Speaks the result back to you.\n","\n","---\n","\n","### **2. Prerequisites**\n","\n","You will need to install a few Python libraries. Open your terminal or command prompt and run:\n","\n","```bash\n","pip install SpeechRecognition pyttsx3 pyaudio\n","\n","```\n","\n","*(Note: If you are on Windows and `pyaudio` fails, you may need to download the `.whl` file manually or install `pipwin` and run `pipwin install pyaudio`.)*\n","\n","---\n","\n","### **3. The AI Agent Code**\n","\n","This script uses `speech_recognition` to listen, `pyttsx3` to speak, and Python's built-in libraries to control the OS and check code."],"metadata":{"id":"jlB5due_xJv1"}},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"03afd589","executionInfo":{"status":"ok","timestamp":1766050076433,"user_tz":-330,"elapsed":11859,"user":{"displayName":"Raaj Malhotra","userId":"06146600545040330347"}},"outputId":"56597055-11f0-4bdb-99ca-3372190b7f92"},"source":["pip install SpeechRecognition pyttsx3 pyaudio"],"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting SpeechRecognition\n","  Downloading speechrecognition-3.14.4-py3-none-any.whl.metadata (30 kB)\n","Collecting pyttsx3\n","  Downloading pyttsx3-2.99-py3-none-any.whl.metadata (6.2 kB)\n","Collecting pyaudio\n","  Downloading PyAudio-0.2.14.tar.gz (47 kB)\n","\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/47.1 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m47.1/47.1 kB\u001b[0m \u001b[31m4.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.12/dist-packages (from SpeechRecognition) (4.15.0)\n","Downloading speechrecognition-3.14.4-py3-none-any.whl (32.9 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m32.9/32.9 MB\u001b[0m \u001b[31m65.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pyttsx3-2.99-py3-none-any.whl (32 kB)\n","Building wheels for collected packages: pyaudio\n","  \u001b[1;31merror\u001b[0m: \u001b[1msubprocess-exited-with-error\u001b[0m\n","  \n","  \u001b[31m×\u001b[0m \u001b[32mBuilding wheel for pyaudio \u001b[0m\u001b[1;32m(\u001b[0m\u001b[32mpyproject.toml\u001b[0m\u001b[1;32m)\u001b[0m did not run successfully.\n","  \u001b[31m│\u001b[0m exit code: \u001b[1;36m1\u001b[0m\n","  \u001b[31m╰─>\u001b[0m See above for output.\n","  \n","  \u001b[1;35mnote\u001b[0m: This error originates from a subprocess, and is likely not a problem with pip.\n","  Building wheel for pyaudio (pyproject.toml) ... \u001b[?25l\u001b[?25herror\n","\u001b[31m  ERROR: Failed building wheel for pyaudio\u001b[0m\u001b[31m\n","\u001b[0mFailed to build pyaudio\n","\u001b[31mERROR: ERROR: Failed to build installable wheels for some pyproject.toml based projects (pyaudio)\u001b[0m\u001b[31m\n","\u001b[0m"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":523},"id":"1c1ad818","executionInfo":{"status":"error","timestamp":1766050076434,"user_tz":-330,"elapsed":32,"user":{"displayName":"Raaj Malhotra","userId":"06146600545040330347"}},"outputId":"e9ed7900-bd0e-4011-98d5-0b7d3acdcdd4"},"source":["import speech_recognition as sr\n","import pyttsx3\n","import os\n","import subprocess\n","import platform\n","import ast\n","import sys\n","\n","# --- CONFIGURATION ---\n","AGENT_NAME = \"Jarvis\"\n","\n","# --- 1. THE MOUTH (Text-to-Speech) ---\n","def speak(text):\n","    \"\"\"Converts text to audible speech.\"\"\"\n","    engine = pyttsx3.init()\n","\n","    # Optional: Adjust voice properties\n","    voices = engine.getProperty('voices')\n","    # engine.setProperty('voice', voices[1].id) # Uncomment to change voice\n","    engine.setProperty('rate', 190) # Speed of speech\n","\n","    print(f\"[{AGENT_NAME}]: {text}\")\n","    engine.say(text)\n","    engine.runAndWait()\n","\n","# --- 2. THE EAR (Speech-to-Text) ---\n","def listen():\n","    \"\"\"Listens to the microphone and returns text.\"\"\"\n","    recognizer = sr.Recognizer()\n","\n","    with sr.Microphone() as source:\n","        print(\"\\nListening...\")\n","        recognizer.adjust_for_ambient_noise(source, duration=0.5)\n","        try:\n","            audio = recognizer.listen(source, timeout=5)\n","            command = recognizer.recognize_google(audio).lower()\n","            print(f\"[User]: {command}\")\n","            return command\n","        except sr.WaitTimeoutError:\n","            return None\n","        except sr.UnknownValueError:\n","            speak(\"I didn't catch that.\")\n","            return None\n","        except sr.RequestError:\n","            speak(\"My speech service is down.\")\n","            return None\n","\n","# --- 3. THE TOOLS (Capabilities) ---\n","\n","def open_file_explorer():\n","    \"\"\"Opens the file explorer based on the OS.\"\"\"\n","    speak(\"Opening File Explorer.\")\n","    system = platform.system()\n","    try:\n","        if system == \"Windows\":\n","            os.startfile(\"explorer\")\n","        elif system == \"Darwin\": # macOS\n","            subprocess.run([\"open\", \".\"])\n","        else: # Linux\n","            subprocess.run([\"xdg-open\", \".\"])\n","    except Exception as e:\n","        speak(f\"I encountered an error opening explorer: {e}\")\n","\n","def check_code_syntax():\n","    \"\"\"Reads a python file and checks for syntax errors.\"\"\"\n","    speak(\"Please say the full path to the python file you want me to check.\")\n","\n","    # For simplicity, we will ask for a path via text input in this demo\n","    # because speaking long file paths is error-prone.\n","    print(\">> Enter file path (e.g., C:/Projects/script.py):\")\n","    file_path = input()\n","\n","    if not os.path.exists(file_path):\n","        speak(\"I cannot find that file.\")\n","        return\n","\n","    try:\n","        with open(file_path, \"r\") as f:\n","            source = f.read()\n","\n","        # Parse the code using Python's Abstract Syntax Tree (AST)\n","        ast.parse(source)\n","        speak(\"The code looks correct! No syntax errors found.\")\n","\n","    except SyntaxError as e:\n","        error_msg = f\"I found a syntax error on line {e.lineno}: {e.msg}\"\n","        speak(error_msg)\n","    except Exception as e:\n","        speak(f\"An error occurred: {e}\")\n","\n","def open_application(app_name):\n","    \"\"\"Generic function to open common apps (Windows example).\"\"\"\n","    speak(f\"Opening {app_name}\")\n","    try:\n","        if \"notepad\" in app_name:\n","            subprocess.Popen(\"notepad.exe\")\n","        elif \"calculator\" in app_name:\n","            subprocess.Popen(\"calc.exe\")\n","        elif \"browser\" in app_name or \"chrome\" in app_name:\n","            # Assumes Chrome is in path or use standard 'start' command\n","            if platform.system() == \"Windows\":\n","                os.system(\"start chrome\")\n","        else:\n","            speak(f\"I don't know how to open {app_name} yet.\")\n","    except Exception as e:\n","        speak(f\"Failed to open {app_name}\")\n","\n","# --- 4. THE BRAIN (Command Processing) ---\n","def process_command(command):\n","    if not command:\n","        return\n","\n","    # Basic Keyword Matching (Intent Recognition)\n","    if \"open file explorer\" in command or \"open my files\" in command:\n","        open_file_explorer()\n","\n","    elif \"check code\" in command or \"debug\" in command:\n","        check_code_syntax()\n","\n","    elif \"open\" in command:\n","        # Extract the app name (e.g., \"open notepad\")\n","        app_name = command.replace(\"open\", \"\").strip()\n","        open_application(app_name)\n","\n","    elif \"stop\" in command or \"exit\" in command:\n","        speak(\"Shutting down. Goodbye.\")\n","        sys.exit()\n","\n","    else:\n","        speak(\"I am not sure how to help with that yet.\")\n","\n","# --- MAIN LOOP ---\n","if __name__ == \"__main__\":\n","    speak(f\"Hello, I am {AGENT_NAME}. How can I help you?\")\n","\n","    while True:\n","        command = listen()\n","        if command:\n","            process_command(command)"],"execution_count":2,"outputs":[{"output_type":"error","ename":"ModuleNotFoundError","evalue":"No module named 'speech_recognition'","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)","\u001b[0;32m/tmp/ipython-input-2128573540.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0;32mimport\u001b[0m \u001b[0mspeech_recognition\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0msr\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mpyttsx3\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0msubprocess\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mplatform\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mModuleNotFoundError\u001b[0m: No module named 'speech_recognition'","","\u001b[0;31m---------------------------------------------------------------------------\u001b[0;32m\nNOTE: If your import is failing due to a missing package, you can\nmanually install dependencies using either !pip or !apt.\n\nTo view examples of installing some common dependencies, click the\n\"Open Examples\" button below.\n\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n"],"errorDetails":{"actions":[{"action":"open_url","actionText":"Open Examples","url":"/notebooks/snippets/importing_libraries.ipynb"}]}}]},{"cell_type":"code","source":["import speech_recognition as sr\n","import pyttsx3\n","import os\n","import subprocess\n","import platform\n","import ast\n","import sys\n","\n","# --- CONFIGURATION ---\n","AGENT_NAME = \"Jarvis\"\n","\n","# --- 1. THE MOUTH (Text-to-Speech) ---\n","def speak(text):\n","    \"\"\"Converts text to audible speech.\"\"\"\n","    engine = pyttsx3.init()\n","\n","    # Optional: Adjust voice properties\n","    voices = engine.getProperty('voices')\n","    # engine.setProperty('voice', voices[1].id) # Uncomment to change voice\n","    engine.setProperty('rate', 190) # Speed of speech\n","\n","    print(f\"[{AGENT_NAME}]: {text}\")\n","    engine.say(text)\n","    engine.runAndWait()\n","\n","# --- 2. THE EAR (Speech-to-Text) ---\n","def listen():\n","    \"\"\"Listens to the microphone and returns text.\"\"\"\n","    recognizer = sr.Recognizer()\n","\n","    with sr.Microphone() as source:\n","        print(\"\\nListening...\")\n","        recognizer.adjust_for_ambient_noise(source, duration=0.5)\n","        try:\n","            audio = recognizer.listen(source, timeout=5)\n","            command = recognizer.recognize_google(audio).lower()\n","            print(f\"[User]: {command}\")\n","            return command\n","        except sr.WaitTimeoutError:\n","            return None\n","        except sr.UnknownValueError:\n","            speak(\"I didn't catch that.\")\n","            return None\n","        except sr.RequestError:\n","            speak(\"My speech service is down.\")\n","            return None\n","\n","# --- 3. THE TOOLS (Capabilities) ---\n","\n","def open_file_explorer():\n","    \"\"\"Opens the file explorer based on the OS.\"\"\"\n","    speak(\"Opening File Explorer.\")\n","    system = platform.system()\n","    try:\n","        if system == \"Windows\":\n","            os.startfile(\"explorer\")\n","        elif system == \"Darwin\": # macOS\n","            subprocess.run([\"open\", \".\"])\n","        else: # Linux\n","            subprocess.run([\"xdg-open\", \".\"])\n","    except Exception as e:\n","        speak(f\"I encountered an error opening explorer: {e}\")\n","\n","def check_code_syntax():\n","    \"\"\"Reads a python file and checks for syntax errors.\"\"\"\n","    speak(\"Please say the full path to the python file you want me to check.\")\n","\n","    # For simplicity, we will ask for a path via text input in this demo\n","    # because speaking long file paths is error-prone.\n","    print(\">> Enter file path (e.g., C:/Projects/script.py):\")\n","    file_path = input()\n","\n","    if not os.path.exists(file_path):\n","        speak(\"I cannot find that file.\")\n","        return\n","\n","    try:\n","        with open(file_path, \"r\") as f:\n","            source = f.read()\n","\n","        # Parse the code using Python's Abstract Syntax Tree (AST)\n","        ast.parse(source)\n","        speak(\"The code looks correct! No syntax errors found.\")\n","\n","    except SyntaxError as e:\n","        error_msg = f\"I found a syntax error on line {e.lineno}: {e.msg}\"\n","        speak(error_msg)\n","    except Exception as e:\n","        speak(f\"An error occurred: {e}\")\n","\n","def open_application(app_name):\n","    \"\"\"Generic function to open common apps (Windows example).\"\"\"\n","    speak(f\"Opening {app_name}\")\n","    try:\n","        if \"notepad\" in app_name:\n","            subprocess.Popen(\"notepad.exe\")\n","        elif \"calculator\" in app_name:\n","            subprocess.Popen(\"calc.exe\")\n","        elif \"browser\" in app_name or \"chrome\" in app_name:\n","            # Assumes Chrome is in path or use standard 'start' command\n","            if platform.system() == \"Windows\":\n","                os.system(\"start chrome\")\n","        else:\n","            speak(f\"I don't know how to open {app_name} yet.\")\n","    except Exception as e:\n","        speak(f\"Failed to open {app_name}\")\n","\n","# --- 4. THE BRAIN (Command Processing) ---\n","def process_command(command):\n","    if not command:\n","        return\n","\n","    # Basic Keyword Matching (Intent Recognition)\n","    if \"open file explorer\" in command or \"open my files\" in command:\n","        open_file_explorer()\n","\n","    elif \"check code\" in command or \"debug\" in command:\n","        check_code_syntax()\n","\n","    elif \"open\" in command:\n","        # Extract the app name (e.g., \"open notepad\")\n","        app_name = command.replace(\"open\", \"\").strip()\n","        open_application(app_name)\n","\n","    elif \"stop\" in command or \"exit\" in command:\n","        speak(\"Shutting down. Goodbye.\")\n","        sys.exit()\n","\n","    else:\n","        speak(\"I am not sure how to help with that yet.\")\n","\n","# --- MAIN LOOP ---\n","if __name__ == \"__main__\":\n","    speak(f\"Hello, I am {AGENT_NAME}. How can I help you?\")\n","\n","    while True:\n","        command = listen()\n","        if command:\n","            process_command(command)"],"outputs":[],"execution_count":null,"metadata":{"id":"9ZEuPO8JxJv9","executionInfo":{"status":"aborted","timestamp":1766050076434,"user_tz":-330,"elapsed":20,"user":{"displayName":"Raaj Malhotra","userId":"06146600545040330347"}}}},{"cell_type":"markdown","source":["---\n","\n","### **4. How it Works**\n","\n","1. **`listen()`**: It captures audio from your mic and sends it to Google's Speech Recognition API (free tier) to convert it to text.\n","2. **`process_command()`**: This is a basic \"Brain.\" It checks if your spoken words match specific keywords like \"open file explorer\".\n","3. **`check_code_syntax()`**: This tool asks for a file path. It reads the file and uses Python's built-in `ast` (Abstract Syntax Tree) module. If the code has bad syntax (like a missing bracket), `ast.parse` will crash with a `SyntaxError`, which the agent catches and reports to you.\n","4. **`open_file_explorer()`**: This uses `os.startfile` (on Windows) to launch the native explorer.\n","\n","### **5. Next Steps to Make it \"Smarter\"**\n","\n","Currently, this agent uses simple keyword matching (`if \"open\" in text`). To make it truly intelligent (understand context, answer complex questions), you need to integrate an LLM like OpenAI or Gemini.\n","\n","**Would you like me to show you how to connect this code to the Gemini API so it can answer questions and write code for you?**"],"metadata":{"id":"kN4JDVrTxJwB"}}],"metadata":{"colab":{"provenance":[{"file_id":"1px13kBuPykXZ7SFsH8dQEL9WHkzbYRHu","timestamp":1766049836166}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}